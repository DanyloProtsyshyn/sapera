<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sapera ‚Äî –°—É—á–∞—Å–Ω–∏–π –ú—ñ–Ω–µ—Å–≤—ñ–ø–µ—Ä</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body.dark { background: linear-gradient(135deg,#0f172a 0%,#1e293b 100%); color: #f3f4f6; }
    body.light { background: linear-gradient(135deg,#e0f2fe 0%,#f9fafb 100%); color: #111827; }
    .cell { width: clamp(28px, 7vw, 40px); height: clamp(28px, 7vw, 40px); display: flex; align-items: center; justify-content: center;
      border-radius: 0.5rem; font-weight: 700; cursor: pointer; user-select: none; 
      transition: transform 0.15s ease, background 0.2s ease, box-shadow 0.2s ease; font-size: clamp(12px, 3.2vw, 18px); }
    .cell.hidden { background: rgba(255,255,255,0.1); backdrop-filter: blur(4px); }
    .cell.hidden:hover { transform: scale(1.05); box-shadow: 0 0 10px rgba(255,255,255,0.2); }
    .cell.revealed { background: rgba(255,255,255,0.9); color: #111827; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); }
    .cell.mine { background: #ef4444; color: #fff; }
    .board { display: grid; gap: clamp(3px, 1vw, 6px); justify-content: center; padding: clamp(8px, 2vw, 20px); border-radius: 1rem;
             background: rgba(255,255,255,0.05); backdrop-filter: blur(10px);
             box-shadow: 0 4px 20px rgba(0,0,0,0.3); }
    header.blur-panel { backdrop-filter: blur(12px); background: rgba(255,255,255,0.05); border-radius: 1rem; }
    button.modern { transition: all 0.2s ease; min-height:44px; }
    button.modern:hover { transform: scale(1.05) translateY(-1px); box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
    @media (max-width: 600px) {
      header.blur-panel { flex-direction: column; gap: 15px; }
      section.flex { grid-template-columns: 1fr; gap: 20px; }
      .sidebar { width: 100%; order: 2; }
      .game-container { order: 1; }
      .btn { padding: 10px 14px; font-size: 14px; }
    }
    @media (max-width: 350px) {
      footer { display: none; }
    }
  </style>
</head>
<body class="dark min-h-screen flex flex-col items-center justify-center p-4">
  <div class="max-w-5xl w-full">
    <header class="blur-panel flex items-center justify-between mb-6 p-4 shadow-lg">
      <div>
        <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight">Sapera ‚Äî –°—É—á–∞—Å–Ω–∏–π –ú—ñ–Ω–µ—Å–≤—ñ–ø–µ—Ä</h1>
        <p class="text-sm opacity-80">–ß–∞—Å, –ø—Ä–∞–ø–æ—Ä—Ü—ñ —Ç–∞ —Å—Ç–∏–ª—å–Ω–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è ‚Äî –≥–æ—Ç–æ–≤–∏–π –≤–∏–∫–ª–∏–∫!</p>
      </div>
      <div class="flex gap-3 items-center">
        <div id="stats" class="bg-white bg-opacity-10 p-3 rounded-2xl text-base font-mono flex gap-4 shadow-inner">
          <span>üí£ <span id="mines-count"></span></span>
          <span>üö© <span id="flags-left"></span></span>
          <span>‚è± <span id="timer">00:00</span></span>
        </div>
        <button id="theme-toggle" class="modern p-3 rounded-2xl bg-gradient-to-r from-cyan-400 to-blue-500 text-white shadow-lg">üåô</button>
        <button id="reset" class="modern px-4 py-2 rounded-2xl bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-semibold shadow-lg">–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏</button>
      </div>
    </header>

    <section class="flex flex-col md:flex-row gap-6">
      <div class="md:w-1/3 sidebar bg-white bg-opacity-5 rounded-2xl p-4 shadow-lg backdrop-blur-md">
        <label class="block text-sm font-medium mb-3">–†—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ</label>
        <div class="flex gap-2 mb-6" id="difficulty">
          <button data-level="easy" class="modern px-4 py-2 rounded-xl bg-gradient-to-r from-green-400 to-emerald-500 text-white">Easy</button>
          <button data-level="medium" class="modern px-4 py-2 rounded-xl bg-gradient-to-r from-yellow-400 to-orange-500 text-white">Medium</button>
          <button data-level="hard" class="modern px-4 py-2 rounded-xl bg-gradient-to-r from-pink-500 to-red-600 text-white">Hard</button>
        </div>
        <div id="status" class="text-lg font-semibold text-center bg-white bg-opacity-10 rounded-xl py-2 shadow-inner">–ì–æ—Ç–æ–≤–∏–π</div>
      </div>

      <div class="md:w-2/3 game-container flex flex-col items-center">
        <div id="board" class="board"></div>
      </div>
    </section>

    <footer class="mt-6 text-center text-sm opacity-70">Made with ‚ù§Ô∏è TailwindCSS + Vanilla JS ‚Äî –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å—É—á–∞—Å–Ω–∏–π –¥–∏–∑–∞–π–Ω</footer>
  </div>

<script>
const DIFFICULTIES = {
  easy: { rows: 9, cols: 9, mines: 10 },
  medium: { rows: 16, cols: 16, mines: 40 },
  hard: { rows: 16, cols: 30, mines: 99 },
};

let rows, cols, mines;
let board = [];
let flagsLeft;
let revealedCount = 0;
let timerInterval = null;
let seconds = 0;
let initialized = false;
let gameOver = false;
let currentDifficulty = 'easy';

function init(difficulty) {
  currentDifficulty = difficulty;
  ({ rows, cols, mines } = DIFFICULTIES[difficulty]);
  board = [];
  flagsLeft = mines;
  revealedCount = 0;
  initialized = false;
  gameOver = false;
  seconds = 0;
  document.getElementById('flags-left').textContent = flagsLeft;
  document.getElementById('mines-count').textContent = mines;
  document.getElementById('timer').textContent = '00:00';
  document.getElementById('status').textContent = '–ì–æ—Ç–æ–≤–∏–π';
  clearInterval(timerInterval);
  renderBoard();
}

function renderBoard() {
  const boardEl = document.getElementById('board');
  boardEl.style.gridTemplateColumns = `repeat(${cols}, clamp(28px, 7vw, 40px))`;
  boardEl.innerHTML = '';
  for (let r=0; r<rows; r++) {
    board[r] = [];
    for (let c=0; c<cols; c++) {
      const cell = { mined: false, revealed: false, flagged: false, adjacent: 0 };
      board[r][c] = cell;
      const div = document.createElement('div');
      div.className = 'cell hidden';
      div.dataset.row = r;
      div.dataset.col = c;
      div.addEventListener('click', onCellClick);
      div.addEventListener('contextmenu', e => { e.preventDefault(); toggleFlag(r,c,div); });
      boardEl.appendChild(div);
    }
  }
}

function startTimer() {
  timerInterval = setInterval(() => {
    seconds++;
    const m = String(Math.floor(seconds / 60)).padStart(2,'0');
    const s = String(seconds % 60).padStart(2,'0');
    document.getElementById('timer').textContent = `${m}:${s}`;
  },1000);
}

function placeMines(firstR, firstC) {
  let placed = 0;
  while (placed < mines) {
    const r = Math.floor(Math.random()*rows);
    const c = Math.floor(Math.random()*cols);
    if ((r===firstR && c===firstC) || board[r][c].mined) continue;
    if (Math.abs(r - firstR) <= 1 && Math.abs(c - firstC) <= 1) continue;
    board[r][c].mined = true;
    placed++;
  }
  for (let r=0;r<rows;r++) {
    for (let c=0;c<cols;c++) {
      if (board[r][c].mined) continue;
      let count=0;
      for (let dr=-1;dr<=1;dr++) {
        for (let dc=-1;dc<=1;dc++) {
          const nr=r+dr,nc=c+dc;
          if(nr>=0 && nr<rows && nc>=0 && nc<cols && board[nr][nc].mined) count++;
        }
      }
      board[r][c].adjacent=count;
    }
  }
}

function reveal(r,c) {
  const cell = board[r][c];
  if (cell.revealed || cell.flagged) return;
  cell.revealed = true;
  revealedCount++;
  const div = document.querySelector(`[data-row='${r}'][data-col='${c}']`);
  div.classList.remove('hidden');
  div.classList.add('revealed');
  if (cell.mined) {
    div.textContent = 'üí£';
    gameOver = true;
    document.getElementById('status').textContent = '–ü—Ä–æ–≥—Ä–∞—à';
    clearInterval(timerInterval);
    revealAllMines();
    return;
  }
  if (cell.adjacent>0) {
    div.textContent = cell.adjacent;
  } else {
    for (let dr=-1;dr<=1;dr++) {
      for (let dc=-1;dc<=1;dc++) {
        const nr=r+dr,nc=c+dc;
        if(nr>=0 && nr<rows && nc>=0 && nc<cols) reveal(nr,nc);
      }
    }
  }
  if (checkWin()) {
    document.getElementById('status').textContent = '–ü–µ—Ä–µ–º–æ–≥–∞';
    clearInterval(timerInterval);
    gameOver = true;
  }
}

function onCellClick(e) {
  const r = +e.target.dataset.row;
  const c = +e.target.dataset.col;
  if (gameOver) return;
  if (!initialized) {
    placeMines(r,c);
    startTimer();
    initialized = true;
  }
  reveal(r,c);
}

function toggleFlag(r,c,div) {
  if (gameOver) return;
  const cell = board[r][c];
  if (cell.revealed) return;
  cell.flagged = !cell.flagged;
  div.textContent = cell.flagged ? 'üö©' : '';
  flagsLeft += cell.flagged ? -1 : 1;
  document.getElementById('flags-left').textContent = flagsLeft;
}

function revealAllMines() {
  for (let r=0;r<rows;r++) {
    for (let c=0;c<cols;c++) {
      if (board[r][c].mined) {
        const div = document.querySelector(`[data-row='${r}'][data-col='${c}']`);
        div.classList.remove('hidden');
        div.classList.add('mine');
        div.textContent = 'üí£';
      }
    }
  }
}

function checkWin() {
  return revealedCount === rows * cols - mines;
}

document.getElementById('reset').addEventListener('click', () => init(currentDifficulty));
document.getElementById('theme-toggle').addEventListener('click', () => {
  document.body.classList.toggle('dark');
  document.body.classList.toggle('light');
});
document.getElementById('difficulty').addEventListener('click', e => {
  if (e.target.dataset.level) init(e.target.dataset.level);
});

init('easy');
</script>
</body>
</html>


